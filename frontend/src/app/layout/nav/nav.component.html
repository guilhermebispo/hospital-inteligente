<div class="container" [class.menu-open]="menuAberto">
  <nav class="sidenav" [class.open]="menuAberto">
    <button mat-icon-button class="close-button" (click)="closeMenu()" [attr.aria-label]="'nav.toggleClose' | translate">
      <mat-icon>close</mat-icon>
    </button>
    <div class="mobile-user" *ngIf="usuario">
      <div class="mobile-user__info">
        <span class="mobile-user__name">{{ usuario }}</span>
        <span class="mobile-user__role">{{ role }}</span>
      </div>
    </div>
    <a routerLink="home" routerLinkActive="active" class="nav-link" (click)="closeMenu()">
      <mat-icon>home</mat-icon>
      <span>{{ 'nav.menu.home' | translate }}</span>
    </a>
    <a routerLink="usuarios" routerLinkActive="active" class="nav-link" *ngIf="perfil == 'ADMIN'" (click)="closeMenu()">
      <mat-icon>person</mat-icon>
      <span>{{ 'nav.menu.users' | translate }}</span>
    </a>

    <div class="sidenav-footer">
      <span class="footer-text">{{ 'app.footer' | translate }}</span>
      <button mat-icon-button class="language-button" [matMenuTriggerFor]="languageMenu" [attr.aria-label]="'app.language.label' | translate">
        <img class="language-flag" [src]="currentLanguageFlag" [alt]="('app.language.' + currentLanguage) | translate">
      </button>
    </div>
  </nav>

  <div class="backdrop" *ngIf="menuAberto" (click)="closeMenu()"></div>

  <div class="sidenav-content">
    <header class="header">
      <button mat-icon-button class="menu-toggle" (click)="toggleMenu()" [attr.aria-label]="'nav.toggleOpen' | translate">
        <mat-icon>menu</mat-icon>
      </button>
      <div class="header-left">
        <img src="/logo.png" alt="{{ 'app.name' | translate }}" class="header-logo">
        <span class="header-title">{{ 'app.name' | translate | uppercase }}</span>
      </div>

      <div class="header-right">
        <div class="user-info">
          <span class="user-name">{{ usuario }}</span>
          <span class="user-role">{{ role }}</span>
        </div>
        <button mat-icon-button [matMenuTriggerFor]="userMenu">
          <mat-icon>account_circle</mat-icon>
        </button>
      </div>
      <mat-menu #userMenu="matMenu" class="custom-menu">
        <button mat-menu-item (click)="alterarSenha()">
          <mat-icon>key</mat-icon>
          <span>{{ 'nav.menu.changePassword' | translate }}</span>
        </button>
        <button mat-menu-item (click)="logout()">
          <mat-icon>logout</mat-icon>
          <span>{{ 'nav.menu.logout' | translate }}</span>
        </button>
      </mat-menu>
      <mat-menu #languageMenu="matMenu">
        <button
          mat-menu-item
          *ngFor="let lang of languages"
          (click)="changeLanguage(lang.code)">
          <img class="language-menu-flag" [src]="lang.flag" [alt]="lang.code">
          <span>{{ lang.labelKey | translate }}</span>
        </button>
      </mat-menu>
    </header>

    <main class="main-content">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>
